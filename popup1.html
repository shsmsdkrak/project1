<!DOCTYPE html>
<html>
    <head>
        <meta charset='UTF-8'>
        <meta name='viewport' content='width=device-width initial-scale=1'>
        <script src="js/control.js"></script>
        <title>팝업1</title>
    </head>
    <body>
        <script>
            // url을 이용해 값을 전달하고 받은 값으로 데이터를 셋팅한다.
            // 기능을 먼저 구현하고 소스코드 리팩토링을 진행한다.

            var body = document.body;
            var control = document.createElement("div");
            control.setAttribute("class", "control");

            for (var i = 1; i < 5; i++) {
                var radio = document.createElement("input");
                radio.setAttribute("type", "radio");
                radio.setAttribute("id", "radio0" + i);
                radio.setAttribute("name", "radio");
                radio.setAttribute("value", "00" + i);
                if (i == 1) {
                    radio.setAttribute("checked", "checked");
                }
                control.appendChild(radio);

                var label = document.createElement("label");
                label.setAttribute("for", "radio0" + i);
                label.setAttribute("id", "label0" + i);
                label.innerText = "00" + i;
                control.appendChild(label);
            }

            body.appendChild(control);

            var control2 = document.createElement("div");
            control2.setAttribute("class", "control");
            var button = document.createElement("button");
            button.setAttribute("type", "button");
            button.setAttribute("id", "save");
            button.innerText = "저장";
            button.addEventListener("click", function (e) {
                debugger;
                var controls = document.querySelectorAll("input");
                var labels = document.querySelectorAll("label");
                var url = "main.html";
                
                for (var i = 0; i < controls.length; i++) {
                    var control = controls[i];
                    if (control.checked) {
                        opener.window.location.href = url + "?val=" + control.value + "&label=" + labels[i];
                    }
                }

                window.close();

            });
            control2.appendChild(button);
            body.appendChild(control2);
            
            
            function getDatadd(search) {
                var obj = {};
                var uri = decodeURI(search);
                uri = uri.slice(1, uri.length);

                var param = uri.split("&");

                for (var i = 0; i < param.length; i++) {
                    var devide = param[i].split("=");
                    obj[devide[0]] = devide[1];
                }

                return obj;
            }

            window.onload = function () {
                var search = window.location.search;
                var getData = getDatadd(search);
                var controls = document.querySelectorAll("input");
                var labels = document.querySelectorAll("label");

                if (getData.val === "BUTTON") {
                    for (var i = 0; i < controls.length; i++) {
                        var control = controls[i];
                        var label = labels[i];

                        if (i == 0 || i == 1) {
                            control.style.display = "none";
                            label.style.display = "none";
                        }
                    }
                }
            }
        </script>
    </body>
</html>